glm.fitE=glm(er_status~tumor+node,
data=BreastCancerDF,family=binomial)
glm.fitP=glm(pr_status~tumor+node,
data=BreastCancerDF,family=binomial)
glm.fitH = glm(her2_final_status~tumor+node,data=BreastCancerDF,family=binomial)
summary(glm.fitE)
glm.probsE=predict(glm.fitE,type="response")
glm.predE=ifelse(glm.probs>0.65,1,0)
attach(BreastCancerDF)
table(glm.predE,er_status)
mean(glm.predE==er_status)
summary(glm.fitP)
glm.probsP=predict(glm.fitP,type="response")
glm.predP=ifelse(glm.probs>0.65,1,0)
attach(BreastCancerDF)
table(glm.predP,pr_status)
mean(glm.predP==pr_status)
summary(glm.fitH)
glm.probsH=predict(glm.fitH,type="response")
glm.predH=ifelse(glm.probs>0.7,1,0)
attach(BreastCancerDF)
table(glm.predH,her2_final_status)
mean(glm.predH==her2_final_status)
train = os_event<1
glm.fit=glm(glm.predH~tumor+node,
data=BreastCancerDF,family=binomial, subset=train)
glm.probs=predict(glm.fit,newdata=BreastCancerDF[!train,],type="response")
glm.pred=ifelse(glm.probs >0.7,1,0)
os_event.one=BreastCancerDF$her2_final_status[!train]
table(glm.pred,os_event.one)
mean(glm.pred==os_event.one)
library(data.world)
require(dplyr)
require(ggplot2)
require(shiny)
library(class)
require(ISLR)
require(MASS)
require(boot)
knitr::opts_chunk$set(echo = TRUE)
project <- "https://data.world/tommywilczek/f-17-eda-project-2"
data.world::set_config(cfg_env("DW_API"))
BreastCancerDF <- data.world::query(data.world::qry_sql("SELECT * FROM BreastCancer"), dataset = project)
qda.fit = qda(alive ~ age_at_initial_pathologic_diagnosis + tumor, data = BreastCancerDF, subset = age_at_initial_pathologic_diagnosis > 60)
qda.fit
qda.class = predict(qda.fit)
BreastCancerDF.less = subset(BreastCancerDF, age_at_initial_pathologic_diagnosis < 60)
qda.pred=predict(qda.fit,BreastCancerDF.less)
table(qda.pred$class,BreastCancerDF.less$alive)
mean(qda.pred$class == BreastCancerDF.less$alive)
qda.fit2 = qda(alive ~  tumor, data = BreastCancerDF, subset = age_at_initial_pathologic_diagnosis > 60)
qda.class2 = predict(qda.fit2)
BreastCancerDF.less = subset(BreastCancerDF, age_at_initial_pathologic_diagnosis < 60)
qda.pred2=predict(qda.fit2,BreastCancerDF.less)
table(qda.pred2$class,BreastCancerDF.less$alive)
mean(qda.pred2$class == BreastCancerDF.less$alive)
lda.fit=lda(pr_status~tumor + node,data=BreastCancerDF, subset=age_at_initial_pathologic_diagnosis<55)
lda.fit
renderPlot(plot(lda.fit))
BreastCancerDF.55=subset(BreastCancerDF,age_at_initial_pathologic_diagnosis>55)
lda.pred=predict(lda.fit,BreastCancerDF.55)
#lda.pred[1:5,]
class(lda.pred)
data.frame(lda.pred)[1:5,]
lda.pred.df = data.frame(lda.pred)
renderPlot(ggplot(lda.pred.df) + geom_histogram(mapping = aes(x=LD1)) + facet_wrap(~ class))
renderPlot(ggplot(lda.pred.df) + geom_boxplot(mapping = aes(x=class, y=LD1)))
table(lda.pred$class,BreastCancerDF.55$pr_status)
mean(lda.pred$class==BreastCancerDF.55$pr_status)
lda.fit=lda(pr_status~tumor + node,data=BreastCancerDF, subset=age_at_initial_pathologic_diagnosis<55)
lda.fit
renderPlot(plot(lda.fit))
BreastCancerDF.55=subset(BreastCancerDF,age_at_initial_pathologic_diagnosis>55)
lda.pred=predict(lda.fit,BreastCancerDF.55)
class(lda.pred)
data.frame(lda.pred)[1:5,]
lda.pred.df = data.frame(lda.pred)
renderPlot(ggplot(lda.pred.df) + geom_histogram(mapping = aes(x=LD1)) + facet_wrap(~ class))
renderPlot(ggplot(lda.pred.df) + geom_boxplot(mapping = aes(x=class, y=LD1)))
table(lda.pred$class,BreastCancerDF.55$pr_status)
mean(lda.pred$class==BreastCancerDF.55$pr_status)
attach(BreastCancerDF)
testSet = cbind(age_at_initial_pathologic_diagnosis,tumor)
is.even <- function(x) x %% 2 == 0
train=is.even(age_at_initial_pathologic_diagnosis)
knn.pred=knn(testSet[train,],testSet[!train,],pr_status[train],k=1)
table(knn.pred,pr_status[!train])
mean(knn.pred==pr_status[!train])
testSet = cbind(node,tumor)
is.even <- function(x) x %% 2 == 0
train=is.even(age_at_initial_pathologic_diagnosis)
knn.pred=knn(testSet[train,],testSet[!train,],alive[train],k=1)
table(knn.pred,alive[!train])
mean(knn.pred==alive[!train])
